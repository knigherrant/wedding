<?php/** * @package		JK Customfields * @version		1.0.0 *  ------------------------------------------------------------------------ * @author    Son Nguyen (PHPKungfu Solutions Co) * @Copyright Â© 2015-2018 phpkungfu.club. All Rights Reserved. * @license - http://www.gnu.org/licenses/gpl-3.0.html GNU/GPL or later. * @Websites: http://www.phpkungfu.club * @Technical Support:  http://www.phpkungfu.club/contacts-------------------------------------------------------------------------*/// No direct access.defined('_JEXEC') or die;jimport('joomla.application.component.controlleradmin');/** * Documents list controller class. */class JKCustomfieldsControllerConfigs extends JControllerAdmin{    public function __construct($config = array())    {        parent::__construct($config);        $this->registerTask('save',	'save');        $this->registerTask('apply', 'save');    }	/**	 * Proxy for getModel.	 * @since	1.6	 */	public function getModel($name = 'configs', $prefix = 'JKCustomfieldsModel', $config = array())	{		$model = parent::getModel($name, $prefix, array('ignore_request' => true));		return $model;	}    public function getConfigs(){        foreach(JKCustomfieldsHelper::$file_ext as $type=>$ext){            $extensions[] = array('type'=>$type, 'title'=>ucwords($type).' files', 'exts'=>$ext);        }        $options = $this->getModel()->getItems();        $options->allowed_extensions = explode(',',$options->allowed_extensions);        //$options->params = json_decode($options->params);        exit(json_encode(array('options'=>$options, 'extensions'=>$extensions)));    }    public function save(){        $model = $this->getModel();        $post = JRequest::get('post');        /*        $maximum_size = floor(JKCustomfieldsHelper::getMaximumUploadSize()/1048576);        if($post['maximum_size'] > $maximum_size){            $this->setRedirect('index.php?option=com_jkcustomfields&view=configs', JText::sprintf('COM_SIGNATUREDOC_MSG_CONFIG_MAXIMUM_SIZE_UPLOAD', $maximum_size), 'error');            return false;        }        /*        if(!is_dir(JPATH_SITE.'/images/com_jkcustomfields/'.$post['document_path'])){            $this->setRedirect('index.php?option=com_jkcustomfields&view=configs', JText::sprintf('COM_SIGNATUREDOC_MSG_CONFIG_PATH_NOT_FOUND', JPATH_SITE.'/images/com_jkcustomfields/'.$post['document_path']), 'error');            return false;        }        if($post['document_import_path'] && !is_dir(JPATH_SITE.'/images/com_jkcustomfields/'.$post['document_path'].'/'.$post['document_import_path'])){            $this->setRedirect('index.php?option=com_jkcustomfields&view=configs', JText::sprintf('COM_SIGNATUREDOC_MSG_CONFIG_PATH_NOT_FOUND', JPATH_SITE.'/images/com_jkcustomfields/'.$post['document_path'].'/'.$post['document_import_path']), 'error');            return false;        }         *          */        $model->save($post);        if($this->getTask() == 'apply') $this->setRedirect('index.php?option=com_jkcustomfields&view=configs', 'Saved!');        else $this->setRedirect('index.php?option=com_jkcustomfields&view=documents', 'Saved!');    }}